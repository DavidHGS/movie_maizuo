{"remainingRequest":"E:\\vue_workspace\\movie\\node_modules\\_vue-loader@15.9.0@vue-loader\\lib\\index.js??vue-loader-options!E:\\vue_workspace\\movie\\src\\views\\film\\nowplaying.vue?vue&type=style&index=0&id=39a2d4a1&lang=scss&scoped=true&","dependencies":[{"path":"E:\\vue_workspace\\movie\\src\\views\\film\\nowplaying.vue","mtime":1584375108717},{"path":"E:\\vue_workspace\\movie\\node_modules\\_css-loader@3.4.2@css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue_workspace\\movie\\node_modules\\_vue-loader@15.9.0@vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\vue_workspace\\movie\\node_modules\\_postcss-loader@3.0.0@postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\vue_workspace\\movie\\node_modules\\_sass-loader@8.0.2@sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue_workspace\\movie\\node_modules\\_cache-loader@4.1.0@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\vue_workspace\\movie\\node_modules\\_vue-loader@15.9.0@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KbGkgew0KICBvdmVyZmxvdzogaGlkZGVuOw0KICBwYWRkaW5nOiAxMHB4Ow0KICBpbWcgew0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIHdpZHRoOiAxMDBweDsNCiAgfQ0KfQ0K"},{"version":3,"sources":["nowplaying.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"nowplaying.vue","sourceRoot":"src/views/film","sourcesContent":["<template>\r\n  <div>\r\n    <ul\r\n      v-infinite-scroll=\"loadMore\"\r\n      infinite-scroll-disabled=\"loading\"\r\n      infinite-scroll-distance=\"0\"\r\n      infinite-scroll-immediate-check=\"false\"\r\n    >\r\n      <li\r\n        v-for=\"data in dataList\"\r\n        :key=\"data.filmId\"\r\n        @click=\"handleChangePage(data.filmId)\"\r\n      >\r\n        <img :src=\"data.poster\" />\r\n        <h3>{{ data.name }}</h3>\r\n        <p>观众评分{{ data.grade }}</p>\r\n        <p>主演：{{ data.actors | actorfilter }}</p>\r\n      </li>\r\n    </ul>\r\n    <div v-if=\"isShow\">正在加载中...</div>\r\n    <div v-else>我是有底线的...</div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport axios from \"axios\";\r\nimport Vue from \"vue\";\r\nimport { Indicator } from \"mint-ui\";\r\nimport { InfiniteScroll } from \"mint-ui\";\r\n\r\nVue.use(InfiniteScroll);\r\n\r\nVue.filter(\"actorfilter\", data => {\r\n  var newlist = data.map(item => item.name);\r\n  return newlist.join(\" \");\r\n});\r\nexport default {\r\n  data() {\r\n    return {\r\n      dataList: [],\r\n      loading: false,\r\n      current: 1,\r\n      total: 0,\r\n      isShow: true,\r\n      cityId: \"\"\r\n    };\r\n  },\r\n  mounted() {\r\n    this.$store.commit(\"isNowplaying\", true);\r\n    Indicator.open({\r\n      text: \"加载中...\",\r\n      spinnerType: \"fading-circle\"\r\n    });\r\n    this.cityId = localStorage.getItem(\"cityId\") || 510100;\r\n    axios({\r\n      url:\r\n        //https://m.maizuo.com/gateway?type=2&cityId=110100&k=5553387\r\n        `https://m.maizuo.com/gateway?cityId=${this.cityId}&pageNum=1&pageSize=10&type=1&k=4945944`,\r\n      headers: {\r\n        \"X-Client-Info\":\r\n          '{\"a\":\"3000\",\"ch\":\"1002\",\"v\":\"5.0.4\",\"e\":\"1584104979768799146087\",\"bc\":\"429004\"}',\r\n        \"X-Host\": \"mall.film-ticket.film.list\"\r\n      }\r\n    }).then(res => {\r\n      this.dataList = res.data.data.films;\r\n      this.total = res.data.data.total;\r\n      Indicator.close();\r\n    });\r\n  },\r\n  methods: {\r\n    handleChangePage(id) {\r\n      //编程式导航--路径跳转\r\n      // this.$router.push(`/detail/${id}`)\r\n      //编程式导航--名字跳转\r\n      this.$router.push({ name: \"detail\", params: { id } });\r\n    },\r\n    loadMore() {\r\n      this.loading = true; //禁用loading\r\n      this.current++;\r\n      if (this.dataList.length === this.total) {\r\n        this.isShow = false;\r\n        return;\r\n      }\r\n      axios({\r\n        url:\r\n          //https://m.maizuo.com/gateway?type=2&cityId=110100&k=5553387\r\n          `https://m.maizuo.com/gateway?cityId=${this.cityId}&pageNum=${this.current}&pageSize=10&type=1&k=4945944`,\r\n        headers: {\r\n          \"X-Client-Info\":\r\n            '{\"a\":\"3000\",\"ch\":\"1002\",\"v\":\"5.0.4\",\"e\":\"1584104979768799146087\",\"bc\":\"429004\"}',\r\n          \"X-Host\": \"mall.film-ticket.film.list\"\r\n        }\r\n      }).then(res => {\r\n        this.dataList = [...this.dataList, ...res.data.data.films];\r\n        Indicator.close();\r\n        this.loading = false;\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\nli {\r\n  overflow: hidden;\r\n  padding: 10px;\r\n  img {\r\n    float: left;\r\n    width: 100px;\r\n  }\r\n}\r\n</style>\r\n"]}]}